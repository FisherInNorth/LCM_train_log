
04/30/2024 10:41:14 - INFO - __main__ - ***** Running training *****
04/30/2024 10:41:14 - INFO - __main__ -   Num batches each epoch = 166672
04/30/2024 10:41:14 - INFO - __main__ -   Num Epochs = 1
04/30/2024 10:41:14 - INFO - __main__ -   Instantaneous batch size per device = 12
04/30/2024 10:41:14 - INFO - __main__ -   Total train batch size (w. parallel, distributed & accumulation) = 24
04/30/2024 10:41:14 - INFO - __main__ -   Gradient Accumulation steps = 1

Steps:   0%|                                                                                                                   | 0/1000 [00:00<?, ?it/s]
/home/hepengyu/anaconda3/envs/test/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.















































































































































































































































































































































































































Steps:  20%|████████████████▊                                                                   | 200/1000 [06:19<25:15,  1.89s/it, loss=0.023, lr=1e-6]
04/30/2024 10:47:34 - INFO - __main__ - Running validation... 
{'timestep_scaling', 'original_inference_steps', 'clip_sample_range', 'rescale_betas_zero_snr', 'sample_max_value', 'dynamic_thresholding_ratio', 'thresholding', 'prediction_type', 'timestep_spacing'} was not found in config. Values will be initialized to default values.


Loading pipeline components...:   0%|                                                                                             | 0/7 [00:00<?, ?it/s]
[A
Loaded tokenizer as CLIPTokenizer from `tokenizer` subfolder of /home/hepengyu/models/LCM_build.


Loading pipeline components...:  29%|████████████████████████▎                                                            | 2/7 [00:00<00:01,  4.57it/s]
[A


Loading pipeline components...:  71%|████████████████████████████████████████████████████████████▋                        | 5/7 [00:00<00:00,  6.05it/s]
[A


Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:00<00:00,  8.14it/s]
Potential NSFW content was detected in one or more images. A black image will be returned instead. Try again with a different prompt and/or seed.
Potential NSFW content was detected in one or more images. A black image will be returned instead. Try again with a different prompt and/or seed.
04/30/2024 10:47:39 - INFO - __main__ - Running validation... 
{'timestep_scaling', 'original_inference_steps', 'clip_sample_range', 'rescale_betas_zero_snr', 'sample_max_value', 'dynamic_thresholding_ratio', 'thresholding', 'prediction_type', 'timestep_spacing'} was not found in config. Values will be initialized to default values.


Loading pipeline components...:   0%|                                                                                             | 0/7 [00:00<?, ?it/s]
[A
Loaded tokenizer as CLIPTokenizer from `tokenizer` subfolder of /home/hepengyu/models/LCM_build.


Loading pipeline components...:  29%|████████████████████████▎                                                            | 2/7 [00:00<00:00,  6.82it/s]
[A


Loading pipeline components...:  71%|████████████████████████████████████████████████████████████▋                        | 5/7 [00:00<00:00,  7.04it/s]
[A


Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:00<00:00,  9.81it/s]
Potential NSFW content was detected in one or more images. A black image will be returned instead. Try again with a different prompt and/or seed.
















































































































































































































































































































































































































Steps:  40%|█████████████████████████████████▌                                                  | 400/1000 [12:47<19:08,  1.91s/it, loss=0.016, lr=1e-6]
04/30/2024 10:54:02 - INFO - __main__ - Running validation... 
{'timestep_scaling', 'original_inference_steps', 'clip_sample_range', 'rescale_betas_zero_snr', 'sample_max_value', 'dynamic_thresholding_ratio', 'thresholding', 'prediction_type', 'timestep_spacing'} was not found in config. Values will be initialized to default values.


Loading pipeline components...:   0%|                                                                                             | 0/7 [00:00<?, ?it/s]
[A
Loaded tokenizer as CLIPTokenizer from `tokenizer` subfolder of /home/hepengyu/models/LCM_build.


Loading pipeline components...:  29%|████████████████████████▎                                                            | 2/7 [00:00<00:00,  5.11it/s]
[A


Loading pipeline components...:  71%|████████████████████████████████████████████████████████████▋                        | 5/7 [00:00<00:00,  6.51it/s]
[A


Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:00<00:00,  8.81it/s]
Potential NSFW content was detected in one or more images. A black image will be returned instead. Try again with a different prompt and/or seed.
Potential NSFW content was detected in one or more images. A black image will be returned instead. Try again with a different prompt and/or seed.
04/30/2024 10:54:07 - INFO - __main__ - Running validation... 
{'timestep_scaling', 'original_inference_steps', 'clip_sample_range', 'rescale_betas_zero_snr', 'sample_max_value', 'dynamic_thresholding_ratio', 'thresholding', 'prediction_type', 'timestep_spacing'} was not found in config. Values will be initialized to default values.


Loading pipeline components...:   0%|                                                                                             | 0/7 [00:00<?, ?it/s]
[A
Loaded tokenizer as CLIPTokenizer from `tokenizer` subfolder of /home/hepengyu/models/LCM_build.


Loading pipeline components...:  29%|████████████████████████▎                                                            | 2/7 [00:00<00:00,  7.63it/s]
[A


Loading pipeline components...:  71%|████████████████████████████████████████████████████████████▋                        | 5/7 [00:00<00:00,  7.97it/s]
[A


Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:00<00:00, 11.08it/s]
















































































































































































































































































































































































































Steps:  60%|█████████████████████████████████████████████████▊                                 | 600/1000 [19:15<12:39,  1.90s/it, loss=0.0237, lr=1e-6]
04/30/2024 11:00:29 - INFO - __main__ - Running validation... 
{'timestep_scaling', 'original_inference_steps', 'clip_sample_range', 'rescale_betas_zero_snr', 'sample_max_value', 'dynamic_thresholding_ratio', 'thresholding', 'prediction_type', 'timestep_spacing'} was not found in config. Values will be initialized to default values.


Loading pipeline components...:   0%|                                                                                             | 0/7 [00:00<?, ?it/s]
[A
Loaded tokenizer as CLIPTokenizer from `tokenizer` subfolder of /home/hepengyu/models/LCM_build.


Loading pipeline components...:  29%|████████████████████████▎                                                            | 2/7 [00:00<00:01,  4.91it/s]
[A


Loading pipeline components...:  71%|████████████████████████████████████████████████████████████▋                        | 5/7 [00:00<00:00,  6.25it/s]
[A


Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:00<00:00,  8.46it/s]
Potential NSFW content was detected in one or more images. A black image will be returned instead. Try again with a different prompt and/or seed.
04/30/2024 11:00:35 - INFO - __main__ - Running validation... 
{'timestep_scaling', 'original_inference_steps', 'clip_sample_range', 'rescale_betas_zero_snr', 'sample_max_value', 'dynamic_thresholding_ratio', 'thresholding', 'prediction_type', 'timestep_spacing'} was not found in config. Values will be initialized to default values.


Loading pipeline components...:   0%|                                                                                             | 0/7 [00:00<?, ?it/s]
[A
Loaded tokenizer as CLIPTokenizer from `tokenizer` subfolder of /home/hepengyu/models/LCM_build.


Loading pipeline components...:  29%|████████████████████████▎                                                            | 2/7 [00:00<00:00,  7.61it/s]
[A


Loading pipeline components...:  71%|████████████████████████████████████████████████████████████▋                        | 5/7 [00:00<00:00,  7.42it/s]
[A


Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:00<00:00, 10.40it/s]
Potential NSFW content was detected in one or more images. A black image will be returned instead. Try again with a different prompt and/or seed.
















































































































































































































































































































































































































Steps:  80%|██████████████████████████████████████████████████████████████████▍                | 800/1000 [25:43<06:19,  1.90s/it, loss=0.0224, lr=1e-6]
04/30/2024 11:06:57 - INFO - __main__ - Running validation... 
{'timestep_scaling', 'original_inference_steps', 'clip_sample_range', 'rescale_betas_zero_snr', 'sample_max_value', 'dynamic_thresholding_ratio', 'thresholding', 'prediction_type', 'timestep_spacing'} was not found in config. Values will be initialized to default values.


Loading pipeline components...:   0%|                                                                                             | 0/7 [00:00<?, ?it/s]
[A
Loaded tokenizer as CLIPTokenizer from `tokenizer` subfolder of /home/hepengyu/models/LCM_build.


Loading pipeline components...:  29%|████████████████████████▎                                                            | 2/7 [00:00<00:00,  5.58it/s]
[A


Loading pipeline components...:  71%|████████████████████████████████████████████████████████████▋                        | 5/7 [00:00<00:00,  7.11it/s]
[A


Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:00<00:00,  9.63it/s]
Potential NSFW content was detected in one or more images. A black image will be returned instead. Try again with a different prompt and/or seed.
04/30/2024 11:07:02 - INFO - __main__ - Running validation... 
{'timestep_scaling', 'original_inference_steps', 'clip_sample_range', 'rescale_betas_zero_snr', 'sample_max_value', 'dynamic_thresholding_ratio', 'thresholding', 'prediction_type', 'timestep_spacing'} was not found in config. Values will be initialized to default values.


Loading pipeline components...:   0%|                                                                                             | 0/7 [00:00<?, ?it/s]
[A
Loaded tokenizer as CLIPTokenizer from `tokenizer` subfolder of /home/hepengyu/models/LCM_build.


Loading pipeline components...:  29%|████████████████████████▎                                                            | 2/7 [00:00<00:00,  8.08it/s]
[A


Loading pipeline components...:  71%|████████████████████████████████████████████████████████████▋                        | 5/7 [00:00<00:00,  8.24it/s]
[A


Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:00<00:00, 11.50it/s]
















































































































































































































































































































































































































Steps: 100%|██████████████████████████████████████████████████████████████████████████████████| 1000/1000 [32:11<00:00,  1.89s/it, loss=0.0284, lr=1e-6]
04/30/2024 11:13:25 - INFO - __main__ - Running validation... 
{'timestep_scaling', 'original_inference_steps', 'clip_sample_range', 'rescale_betas_zero_snr', 'sample_max_value', 'dynamic_thresholding_ratio', 'thresholding', 'prediction_type', 'timestep_spacing'} was not found in config. Values will be initialized to default values.


Loading pipeline components...:   0%|                                                                                             | 0/7 [00:00<?, ?it/s]
[A
Loaded tokenizer as CLIPTokenizer from `tokenizer` subfolder of /home/hepengyu/models/LCM_build.


Loading pipeline components...:  29%|████████████████████████▎                                                            | 2/7 [00:00<00:00,  5.27it/s]
[A


Loading pipeline components...:  71%|████████████████████████████████████████████████████████████▋                        | 5/7 [00:00<00:00,  6.65it/s]
[A


Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:00<00:00,  9.02it/s]
04/30/2024 11:13:30 - INFO - __main__ - Running validation... 
{'timestep_scaling', 'original_inference_steps', 'clip_sample_range', 'rescale_betas_zero_snr', 'sample_max_value', 'dynamic_thresholding_ratio', 'thresholding', 'prediction_type', 'timestep_spacing'} was not found in config. Values will be initialized to default values.


Loading pipeline components...:   0%|                                                                                             | 0/7 [00:00<?, ?it/s]
[A
Loaded tokenizer as CLIPTokenizer from `tokenizer` subfolder of /home/hepengyu/models/LCM_build.


Loading pipeline components...:  29%|████████████████████████▎                                                            | 2/7 [00:00<00:00,  8.28it/s]
[A


Loading pipeline components...:  71%|████████████████████████████████████████████████████████████▋                        | 5/7 [00:00<00:00,  8.11it/s]
[A


Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:00<00:00, 11.36it/s]

Steps: 100%|██████████████████████████████████████████████████████████████████████████████████| 1000/1000 [32:21<00:00,  1.89s/it, loss=0.0406, lr=1e-6]
Configuration saved in /home/hepengyu/trainingLCM/round3k=8num=2000/output/unet/config.json
Model weights saved in /home/hepengyu/trainingLCM/round3k=8num=2000/output/unet/diffusion_pytorch_model.safetensors
Configuration saved in /home/hepengyu/trainingLCM/round3k=8num=2000/output/unet_target/config.json
Model weights saved in /home/hepengyu/trainingLCM/round3k=8num=2000/output/unet_target/diffusion_pytorch_model.safetensors
Checkpoint 'latest' does not exist. Starting a new training run.