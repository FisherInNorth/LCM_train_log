
04/29/2024 14:51:24 - INFO - __main__ - ***** Running training *****
04/29/2024 14:51:24 - INFO - __main__ -   Num batches each epoch = 166672
04/29/2024 14:51:24 - INFO - __main__ -   Num Epochs = 1
04/29/2024 14:51:24 - INFO - __main__ -   Instantaneous batch size per device = 12
04/29/2024 14:51:24 - INFO - __main__ -   Total train batch size (w. parallel, distributed & accumulation) = 24
04/29/2024 14:51:24 - INFO - __main__ -   Gradient Accumulation steps = 1

Steps:   0%|                                                                                                     | 0/1000 [00:00<?, ?it/s]
/home/hepengyu/anaconda3/envs/test/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.















































































































































































































































































































































































































Steps:  20%|█████████████▊                                                       | 200/1000 [06:19<25:13,  1.89s/it, loss=0.0393, lr=1e-6]
04/29/2024 14:57:43 - INFO - __main__ - Running validation... 
{'thresholding', 'sample_max_value', 'rescale_betas_zero_snr', 'original_inference_steps', 'clip_sample_range', 'prediction_type', 'timestep_spacing', 'timestep_scaling', 'dynamic_thresholding_ratio'} was not found in config. Values will be initialized to default values.


Loading pipeline components...:   0%|                                                                               | 0/7 [00:00<?, ?it/s]
[A
Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of /home/hepengyu/models/LCM_build.


Loading pipeline components...:  71%|██████████████████████████████████████████████████▋                    | 5/7 [00:00<00:00, 13.06it/s]
[A
Loaded tokenizer as CLIPTokenizer from `tokenizer` subfolder of /home/hepengyu/models/LCM_build.


Loading pipeline components...: 100%|███████████████████████████████████████████████████████████████████████| 7/7 [00:00<00:00,  7.54it/s]


Loading pipeline components...: 100%|███████████████████████████████████████████████████████████████████████| 7/7 [00:00<00:00,  8.29it/s]
Potential NSFW content was detected in one or more images. A black image will be returned instead. Try again with a different prompt and/or seed.
Potential NSFW content was detected in one or more images. A black image will be returned instead. Try again with a different prompt and/or seed.
04/29/2024 14:57:48 - INFO - __main__ - Running validation... 
{'thresholding', 'sample_max_value', 'rescale_betas_zero_snr', 'original_inference_steps', 'clip_sample_range', 'prediction_type', 'timestep_spacing', 'timestep_scaling', 'dynamic_thresholding_ratio'} was not found in config. Values will be initialized to default values.


Loading pipeline components...:   0%|                                                                               | 0/7 [00:00<?, ?it/s]
[A
Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of /home/hepengyu/models/LCM_build.


Loading pipeline components...:  71%|██████████████████████████████████████████████████▋                    | 5/7 [00:00<00:00, 21.88it/s]
[A
Loaded tokenizer as CLIPTokenizer from `tokenizer` subfolder of /home/hepengyu/models/LCM_build.


Loading pipeline components...: 100%|███████████████████████████████████████████████████████████████████████| 7/7 [00:00<00:00, 10.46it/s]
Potential NSFW content was detected in one or more images. A black image will be returned instead. Try again with a different prompt and/or seed.
















































































































































































































































































































































































































Steps:  40%|███████████████████████████▌                                         | 400/1000 [12:47<19:00,  1.90s/it, loss=0.0329, lr=1e-6]
04/29/2024 15:04:11 - INFO - __main__ - Running validation... 
{'thresholding', 'sample_max_value', 'rescale_betas_zero_snr', 'original_inference_steps', 'clip_sample_range', 'prediction_type', 'timestep_spacing', 'timestep_scaling', 'dynamic_thresholding_ratio'} was not found in config. Values will be initialized to default values.


Loading pipeline components...:   0%|                                                                               | 0/7 [00:00<?, ?it/s]
[A
Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of /home/hepengyu/models/LCM_build.


Loading pipeline components...:  71%|██████████████████████████████████████████████████▋                    | 5/7 [00:00<00:00, 11.81it/s]
[A
Loaded tokenizer as CLIPTokenizer from `tokenizer` subfolder of /home/hepengyu/models/LCM_build.


Loading pipeline components...: 100%|███████████████████████████████████████████████████████████████████████| 7/7 [00:00<00:00,  7.20it/s]


Loading pipeline components...: 100%|███████████████████████████████████████████████████████████████████████| 7/7 [00:00<00:00,  7.85it/s]
Potential NSFW content was detected in one or more images. A black image will be returned instead. Try again with a different prompt and/or seed.
04/29/2024 15:04:16 - INFO - __main__ - Running validation... 
{'thresholding', 'sample_max_value', 'rescale_betas_zero_snr', 'original_inference_steps', 'clip_sample_range', 'prediction_type', 'timestep_spacing', 'timestep_scaling', 'dynamic_thresholding_ratio'} was not found in config. Values will be initialized to default values.


Loading pipeline components...:   0%|                                                                               | 0/7 [00:00<?, ?it/s]
[A
Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of /home/hepengyu/models/LCM_build.


Loading pipeline components...:  71%|██████████████████████████████████████████████████▋                    | 5/7 [00:00<00:00, 23.35it/s]
[A
Loaded tokenizer as CLIPTokenizer from `tokenizer` subfolder of /home/hepengyu/models/LCM_build.


Loading pipeline components...: 100%|███████████████████████████████████████████████████████████████████████| 7/7 [00:00<00:00, 10.63it/s]
















































































































































































































































































































































































































Steps:  60%|█████████████████████████████████████████▍                           | 600/1000 [19:14<12:37,  1.89s/it, loss=0.0524, lr=1e-6]
04/29/2024 15:10:38 - INFO - __main__ - Running validation... 
{'thresholding', 'sample_max_value', 'rescale_betas_zero_snr', 'original_inference_steps', 'clip_sample_range', 'prediction_type', 'timestep_spacing', 'timestep_scaling', 'dynamic_thresholding_ratio'} was not found in config. Values will be initialized to default values.


Loading pipeline components...:   0%|                                                                               | 0/7 [00:00<?, ?it/s]
[A
Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of /home/hepengyu/models/LCM_build.


Loading pipeline components...:  71%|██████████████████████████████████████████████████▋                    | 5/7 [00:00<00:00, 15.34it/s]
[A
Loaded tokenizer as CLIPTokenizer from `tokenizer` subfolder of /home/hepengyu/models/LCM_build.


Loading pipeline components...: 100%|███████████████████████████████████████████████████████████████████████| 7/7 [00:00<00:00,  7.90it/s]


Loading pipeline components...: 100%|███████████████████████████████████████████████████████████████████████| 7/7 [00:00<00:00,  8.81it/s]
Potential NSFW content was detected in one or more images. A black image will be returned instead. Try again with a different prompt and/or seed.
04/29/2024 15:10:43 - INFO - __main__ - Running validation... 
{'thresholding', 'sample_max_value', 'rescale_betas_zero_snr', 'original_inference_steps', 'clip_sample_range', 'prediction_type', 'timestep_spacing', 'timestep_scaling', 'dynamic_thresholding_ratio'} was not found in config. Values will be initialized to default values.


Loading pipeline components...:   0%|                                                                               | 0/7 [00:00<?, ?it/s]
[A
Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of /home/hepengyu/models/LCM_build.


Loading pipeline components...:  71%|██████████████████████████████████████████████████▋                    | 5/7 [00:00<00:00, 23.28it/s]
[A
Loaded tokenizer as CLIPTokenizer from `tokenizer` subfolder of /home/hepengyu/models/LCM_build.


















































































































































































































































































































































































































Steps:  80%|███████████████████████████████████████████████████████▏             | 800/1000 [25:41<06:18,  1.89s/it, loss=0.0441, lr=1e-6]
04/29/2024 15:17:05 - INFO - __main__ - Running validation... 
{'thresholding', 'sample_max_value', 'rescale_betas_zero_snr', 'original_inference_steps', 'clip_sample_range', 'prediction_type', 'timestep_spacing', 'timestep_scaling', 'dynamic_thresholding_ratio'} was not found in config. Values will be initialized to default values.


Loading pipeline components...:   0%|                                                                               | 0/7 [00:00<?, ?it/s]
[A
Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of /home/hepengyu/models/LCM_build.


Loading pipeline components...:  71%|██████████████████████████████████████████████████▋                    | 5/7 [00:00<00:00, 15.28it/s]
[A
Loaded tokenizer as CLIPTokenizer from `tokenizer` subfolder of /home/hepengyu/models/LCM_build.


Loading pipeline components...: 100%|███████████████████████████████████████████████████████████████████████| 7/7 [00:00<00:00,  8.75it/s]


Loading pipeline components...: 100%|███████████████████████████████████████████████████████████████████████| 7/7 [00:00<00:00,  9.63it/s]
Potential NSFW content was detected in one or more images. A black image will be returned instead. Try again with a different prompt and/or seed.
04/29/2024 15:17:10 - INFO - __main__ - Running validation... 
{'thresholding', 'sample_max_value', 'rescale_betas_zero_snr', 'original_inference_steps', 'clip_sample_range', 'prediction_type', 'timestep_spacing', 'timestep_scaling', 'dynamic_thresholding_ratio'} was not found in config. Values will be initialized to default values.


Loading pipeline components...:   0%|                                                                               | 0/7 [00:00<?, ?it/s]
[A
Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of /home/hepengyu/models/LCM_build.


Loading pipeline components...:  71%|██████████████████████████████████████████████████▋                    | 5/7 [00:00<00:00, 24.92it/s]
[A
Loaded tokenizer as CLIPTokenizer from `tokenizer` subfolder of /home/hepengyu/models/LCM_build.


















































































































































































































































































































































































































Steps: 100%|████████████████████████████████████████████████████████████████████| 1000/1000 [32:09<00:00,  1.90s/it, loss=0.0455, lr=1e-6]
04/29/2024 15:23:33 - INFO - __main__ - Running validation... 
{'thresholding', 'sample_max_value', 'rescale_betas_zero_snr', 'original_inference_steps', 'clip_sample_range', 'prediction_type', 'timestep_spacing', 'timestep_scaling', 'dynamic_thresholding_ratio'} was not found in config. Values will be initialized to default values.


Loading pipeline components...:   0%|                                                                               | 0/7 [00:00<?, ?it/s]
[A
Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of /home/hepengyu/models/LCM_build.


Loading pipeline components...:  71%|██████████████████████████████████████████████████▋                    | 5/7 [00:00<00:00, 14.57it/s]
[A
Loaded tokenizer as CLIPTokenizer from `tokenizer` subfolder of /home/hepengyu/models/LCM_build.


Loading pipeline components...: 100%|███████████████████████████████████████████████████████████████████████| 7/7 [00:00<00:00,  7.87it/s]


Loading pipeline components...: 100%|███████████████████████████████████████████████████████████████████████| 7/7 [00:00<00:00,  8.72it/s]
Potential NSFW content was detected in one or more images. A black image will be returned instead. Try again with a different prompt and/or seed.
04/29/2024 15:23:38 - INFO - __main__ - Running validation... 
{'thresholding', 'sample_max_value', 'rescale_betas_zero_snr', 'original_inference_steps', 'clip_sample_range', 'prediction_type', 'timestep_spacing', 'timestep_scaling', 'dynamic_thresholding_ratio'} was not found in config. Values will be initialized to default values.


Loading pipeline components...:   0%|                                                                               | 0/7 [00:00<?, ?it/s]
[A
Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of /home/hepengyu/models/LCM_build.


Loading pipeline components...:  71%|██████████████████████████████████████████████████▋                    | 5/7 [00:00<00:00, 22.38it/s]
[A
Loaded tokenizer as CLIPTokenizer from `tokenizer` subfolder of /home/hepengyu/models/LCM_build.


Loading pipeline components...: 100%|███████████████████████████████████████████████████████████████████████| 7/7 [00:00<00:00, 10.30it/s]

Steps: 100%|████████████████████████████████████████████████████████████████████| 1000/1000 [32:18<00:00,  1.90s/it, loss=0.0902, lr=1e-6]
Configuration saved in /home/hepengyu/trainingLCM/output/unet/config.json
Model weights saved in /home/hepengyu/trainingLCM/output/unet/diffusion_pytorch_model.safetensors
Configuration saved in /home/hepengyu/trainingLCM/output/unet_target/config.json
Model weights saved in /home/hepengyu/trainingLCM/output/unet_target/diffusion_pytorch_model.safetensors
Checkpoint 'latest' does not exist. Starting a new training run.